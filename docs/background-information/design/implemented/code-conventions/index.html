<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-background-information/design/implemented/code-conventions">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">RFC: Code Conventions | Evo.lua</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://evo-lua.github.io/docs/background-information/design/implemented/code-conventions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="RFC: Code Conventions | Evo.lua"><meta data-rh="true" name="description" content="This document describes the rationale behind Evo&#x27;s code conventions"><meta data-rh="true" property="og:description" content="This document describes the rationale behind Evo&#x27;s code conventions"><link data-rh="true" rel="icon" href="/img/caterpillar.png"><link data-rh="true" rel="canonical" href="https://evo-lua.github.io/docs/background-information/design/implemented/code-conventions"><link data-rh="true" rel="alternate" href="https://evo-lua.github.io/docs/background-information/design/implemented/code-conventions" hreflang="en"><link data-rh="true" rel="alternate" href="https://evo-lua.github.io/docs/background-information/design/implemented/code-conventions" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.850cdc2e.css">
<link rel="preload" href="/assets/js/runtime~main.6ea80717.js" as="script">
<link rel="preload" href="/assets/js/main.3ef2f3bf.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/caterpillar.png" alt="Evo.lua Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/caterpillar.png" alt="Evo.lua Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Evo.lua</b></a><a class="navbar__item navbar__link" href="/docs">Documentation</a><a class="navbar__item navbar__link" href="/docs/category/api">API Overview</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/evo-lua" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Documentation Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/background-information">Background Information</a><button aria-label="Toggle the collapsible sidebar category &#x27;Background Information&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/design-documents">Design Documents</a><button aria-label="Toggle the collapsible sidebar category &#x27;Design Documents&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/drafts">Drafts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Drafts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/implemented">Implemented</a><button aria-label="Toggle the collapsible sidebar category &#x27;Implemented&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/background-information/design/implemented/build-system-rework">RFC: Ninja-based Builds</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/background-information/design/implemented/code-conventions">RFC: Code Conventions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/background-information/design/implemented/event-handling">RFC: Event Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/background-information/design/implemented/testing-architecture">RFC: Smoke Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/background-information/design/implemented/unit-test-runner">RFC: Builtin Test Runner</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/background-information/design/template">Template</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/luajit-notes">LuaJIT Notes</a><button aria-label="Toggle the collapsible sidebar category &#x27;LuaJIT Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/background-information/the-evo-philosophy">The Evo Philosophy</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/references">References</a><button aria-label="Toggle the collapsible sidebar category &#x27;References&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/background-information"><span itemprop="name">Background Information</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/design-documents"><span itemprop="name">Design Documents</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/implemented"><span itemprop="name">Implemented</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">RFC: Code Conventions</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>RFC: Code Conventions</h1><p>This document describes the rationale behind Evo&#x27;s code conventions</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="separate-styles-for-lua-and-native-components">Separate Styles for Lua and Native Components<a href="#separate-styles-for-lua-and-native-components" class="hash-link" aria-label="Direct link to Separate Styles for Lua and Native Components" title="Direct link to Separate Styles for Lua and Native Components">​</a></h2><p>What is idiomatic in Lua may not be in C or C++, and vice versa. Additionally, low-level code often is written in a way that makes it more difficult to read and understand<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>. Programmers working on a high-level of abstraction presumably have different expectations than those working with lower-level languages and concepts, so it seems reasonable to treat native code differently than Lua code, especially since much of the native libraries are provided by third parties<sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>.</p><p><em><sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> I&#x27;m primarily referring to naming conventions, use of opaque abbreviations, lack of useful abstractions, lack of modularity, and other such issues unrelated to the syntax of the language itself (which may further add to the problem).</em></p><p><em><sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup> The code written by library authors may follow arbitrary conventions that don&#x27;t necessarily translate well to Lua.</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="finding-a-stylistic-vision">Finding a Stylistic Vision<a href="#finding-a-stylistic-vision" class="hash-link" aria-label="Direct link to Finding a Stylistic Vision" title="Direct link to Finding a Stylistic Vision">​</a></h2><p>But what styles should be adopted? Unfortunately, there is no one true way of writing C or C++, and definitely not Lua.</p><p>Let&#x27;s first see what some of the existing conventions are, where they originate, and what the benefits and drawbacks are.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-survey-of-code-style-issues">A Survey of Code Style Issues<a href="#a-survey-of-code-style-issues" class="hash-link" aria-label="Direct link to A Survey of Code Style Issues" title="Direct link to A Survey of Code Style Issues">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tabs-vs-spaces">Tabs vs. Spaces<a href="#tabs-vs-spaces" class="hash-link" aria-label="Direct link to Tabs vs. Spaces" title="Direct link to Tabs vs. Spaces">​</a></h3><p>Here are some benefits of using tabs:</p><ul><li>Semantically, the tab key is exactly what you want to use when indenting code</li><li>It somewhat reduces file size on disk, at least for raw textual data</li><li>The indentation size can be adjusted to provide a perfect experience for every developer</li></ul><p>And here are some benefits of using spaces:</p><ul><li>You get to train your fingers by pressing the space key twice as many times as would be required for pressing tabs</li><li>You may be earning more money than those tab-indenting peasants (or so <a href="https://stackoverflow.blog/2017/06/15/developers-use-spaces-make-money-use-tabs/" target="_blank" rel="noopener noreferrer">this blog post half-jokingly claims</a>)</li></ul><p>This is actually not a serious comparison (if you couldn&#x27;t tell). I can&#x27;t think of any real reasons to use spaces over tabs, so let&#x27;s not. If someone disagrees, it is trivial to set up some tooling that automatically converts between the two.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="capitalization-rules">Capitalization Rules<a href="#capitalization-rules" class="hash-link" aria-label="Direct link to Capitalization Rules" title="Direct link to Capitalization Rules">​</a></h3><p>I&#x27;m not an expert in Human-Computer-Interaction, but <a href="https://ux.stackexchange.com/questions/67454/how-does-capitalization-affect-readability" target="_blank" rel="noopener noreferrer">some cursory research</a> indicates that there may be benefits to adopting capitalization for &quot;important&quot; concepts, which hopefully would improve reading comprehension.</p><p>So what are the drawbacks of using capitalized names? I can think of a few:</p><ul><li>You&#x27;ll have to think even harder about whether to (and what to) capitalize</li><li>If you overshoot the target, you may end up in the <a href="http://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html" target="_blank" rel="noopener noreferrer">Kingdom of Nouns</a> - a terrible thought, indeed</li></ul><p>None of that seems enough of a drawback to eschew capital letters altogether, though.</p><p>For the documentation, I would consider title case more &quot;authoritative&quot; and sentence case more conversational.
It&#x27;s probably acceptable to keep the <code>lowercase</code> or even <code>snake_case</code> for low-level code, especially the embedded libraries. And for the Lua (and C++) code I&#x27;d consider <code>camelCase</code> or <code>PascalCase</code> to be a better convention that fits stylistically.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="semicolons">Semicolons<a href="#semicolons" class="hash-link" aria-label="Direct link to Semicolons" title="Direct link to Semicolons">​</a></h3><p>Some less civilized languages still cling to this ancient tradition. Thankfully, Lua has made them entirely optional.</p><p>Needless to say, they add very little (except visual clutter) and so there needn&#x27;t be any in Evo&#x27;s Lua codebase.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="magic-globals">Magic Globals<a href="#magic-globals" class="hash-link" aria-label="Direct link to Magic Globals" title="Direct link to Magic Globals">​</a></h3><p>The global environment is a key concept in Lua&#x27;s design, so painstakingly avoiding to use it seems silly. Primarily, the question is which nonstandard builtins and libraries should be exported globally. This number should be relatively small, though it needn&#x27;t be zero, because there are some drawbacks to providing additional global exports:</p><ul><li>Anything in the global environment may potentially collide with userland code</li><li>If unused packages are preloaded and exported, resource usage increases (slightly)</li><li>There is a much smaller benefit for frequently-accessed globals in places where it would usually be upvalued</li><li>This is because typing one line to <code>require</code> a module is mostly the same work as creating a local copy of a gobal</li></ul><p>However, there are certain areas where having packages or even just functions pre-exported really saves a lot of hassle:</p><ul><li>In test files, which won&#x27;t benefit from local upvalues, assertions and testing primitives should be readily available</li><li>Commonly-used functions that don&#x27;t get upvalued anyway, such as formatted printing (<code>printf</code>)</li><li>Cross-cutting concerns, such as functions for logging debug messages (e.g., <code>WARNING</code> or <code>DEBUG</code>)</li></ul><p>I think it&#x27;s perfectly alright to export those as globals, and I can&#x27;t see there being enough of them to cause problems.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="enumerations-and-shared-constants">Enumerations and (Shared) Constants<a href="#enumerations-and-shared-constants" class="hash-link" aria-label="Direct link to Enumerations and (Shared) Constants" title="Direct link to Enumerations and (Shared) Constants">​</a></h3><p>I don&#x27;t think anyone has ever invented a better convention, so let&#x27;s just use the C-style <code>CAPITAL_CASE</code> naming here.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="autoformat-wherever-possible">Autoformat Wherever Possible<a href="#autoformat-wherever-possible" class="hash-link" aria-label="Direct link to Autoformat Wherever Possible" title="Direct link to Autoformat Wherever Possible">​</a></h2><p>Regardless of which style one considers ideal, it&#x27;s clear that any and all formatting issues are moot with <code>clang-format</code>.</p><p>Changing the rules is trivial, so let&#x27;s focus on the stylistic questions that can&#x27;t be automated: Capitalization and globals.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="by-royal-decree-tldr">By Royal Decree (TL;DR)<a href="#by-royal-decree-tldr" class="hash-link" aria-label="Direct link to By Royal Decree (TL;DR)" title="Direct link to By Royal Decree (TL;DR)">​</a></h2><p>I hereby declare the following conventions should be used:</p><ul><li>Low-level bindings exposing embedded libraries use <code>snake_case</code>, because that&#x27;s what those libraries use as well</li><li>C++ code uses <code>camelCase</code> for variables and regular functions, but <code>PascalCase</code> for objects, namespaces, etc.</li><li>Lua code uses <code>camelCase</code> for regular functions or variables, but <code>PascalCase</code> for objects and high-level APIs</li></ul><p>The specifics shall be published on a <a href="/docs/references/code-conventions">separate reference page</a> posthaste. You may now leave this website, peasant.<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup></p><p><sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> <em>Actually, I&#x27;m always open to changes if there are good reasons to use a different convention.</em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/evo-lua/evo-lua.github.io/edit/main/docs/background-information/design/implemented/code-conventions.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/background-information/design/implemented/build-system-rework"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RFC: Ninja-based Builds</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/background-information/design/implemented/event-handling"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">RFC: Event Handling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#separate-styles-for-lua-and-native-components" class="table-of-contents__link toc-highlight">Separate Styles for Lua and Native Components</a></li><li><a href="#finding-a-stylistic-vision" class="table-of-contents__link toc-highlight">Finding a Stylistic Vision</a></li><li><a href="#a-survey-of-code-style-issues" class="table-of-contents__link toc-highlight">A Survey of Code Style Issues</a><ul><li><a href="#tabs-vs-spaces" class="table-of-contents__link toc-highlight">Tabs vs. Spaces</a></li><li><a href="#capitalization-rules" class="table-of-contents__link toc-highlight">Capitalization Rules</a></li><li><a href="#semicolons" class="table-of-contents__link toc-highlight">Semicolons</a></li><li><a href="#magic-globals" class="table-of-contents__link toc-highlight">Magic Globals</a></li><li><a href="#enumerations-and-shared-constants" class="table-of-contents__link toc-highlight">Enumerations and (Shared) Constants</a></li></ul></li><li><a href="#autoformat-wherever-possible" class="table-of-contents__link toc-highlight">Autoformat Wherever Possible</a></li><li><a href="#by-royal-decree-tldr" class="table-of-contents__link toc-highlight">By Royal Decree (TL;DR)</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021-2023 · Evo.lua authors and contributors</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6ea80717.js"></script>
<script src="/assets/js/main.3ef2f3bf.js"></script>
</body>
</html>